rm -Rf bin
mkdir bin
mkdir bin/mac

pushd .
cd "../plugins/slOscilloscope/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/Spectrum Analyzer/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/Tone Generator/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/Channel Mute/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/Maths/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/AB Tester/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/AddInvert/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pushd .
cd "../plugins/SFX8/Builds/MacOSX"
xcodebuild -configuration Release || exit 1
popd

pwd
cp -R ~/Library/Audio/Plug-Ins/VST/Oscilloscope.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/SpectrumAnalyzer.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/ToneGenerator.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/ChannelMute.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/Maths.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/ABTester.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/AddInvert.vst bin
cp -R ~/Library/Audio/Plug-Ins/VST/SFX8.vst bin

cp -R ~/Library/Audio/Plug-Ins/Components/Oscilloscope.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/SpectrumAnalyzer.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/ToneGenerator.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/ChannelMute.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/Maths.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/ABTester.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/AddInvert.component bin
cp -R ~/Library/Audio/Plug-Ins/Components/SFX8.component bin

cd bin
for filename in ./*.vst; do
  codesign -s "$DEV_APP_ID" -v "$filename"
done
for filename in ./*.component; do
  codesign -s "$DEV_APP_ID" -v "$filename" 
done
cd ..

cd bin
zip -r Oscilloscope_Mac.zip Oscilloscope.vst Oscilloscope.component
zip -r SpectrumAnalyzer_Mac.zip SpectrumAnalyzer.vst SpectrumAnalyzer.component
zip -r ToneGenerator_Mac.zip ToneGenerator.vst ToneGenerator.component
zip -r ChannelMute_Mac.zip ChannelMute.vst ChannelMute.component
zip -r Maths_Mac.zip Maths.vst Maths.component
zip -r ABTester_Mac.zip ABTester.vst ABTester.component
zip -r AddInvert_Mac.zip AddInvert.vst AddInvert.component
zip -r SFX8_Mac.zip SFX8.vst SFX8.component
cp *.zip mac
cd ..
